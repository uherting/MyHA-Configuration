# ############################################################
#
#  automation for ZB Charger 01 to switch it ON based on battery percentage
#
# ############################################################

# ############################################################
# ZB Charger 01 turn on
# ############################################################
- alias: Zigbee Charger 01 ON
  id: "e7ddfee3-d661-4618-b4ba-eb43950ce068"
  initial_state: true
  # --------------------- TRIGGER ---------------------
  # if the phone's battery is below x% ...
  trigger:
    - platform: template
      value_template: "{{ states('binary_sensor.trigger_zb_charger_01_charging_based_on_percentage') == 'on' }}"
  # -------------------- CONDITIONS -------------------
  condition:
    - and:
        # make sure that the owner of the switch is at home
        - condition: template
          value_template: "{{ states('binary_sensor.home_uwe_is_here') == 'on' }}"
        # switch is not on
        - condition: template
          value_template: "{{ states('switch.zb_charger_01') != 'on' }}"
        # charger functionalitity enabled
        - condition: template
          value_template: "{{ is_state('input_boolean.zb_charger_01_functionality', 'on') }}"
        # charching only if no delayed start of charging enabled
        - condition: template
          value_template: "{{ is_state('input_boolean.zb_charger_01_force_delayed', 'off') }}"
  # --------------------- ACTIONS ---------------------
  action:
    # ------------------ ZB Plug ON ------------------
    service: switch.turn_on
    entity_id: switch.zb_charger_01
# ############################################################
#  END OF FILE
# ############################################################
