# ############################################################
#
#  automation for Zigbee plug zb_plug_l2_kitchen_microwave_power
#
# ############################################################

# ############################################################
# Zigbee plug zb_plug_l2_kitchen_microwave_power turn off after x minutes
# ############################################################
- alias: Zigbee Plug zb_plug_l2_kitchen_microwave_power
  id: "f7124d47-174f-4c08-9c2a-d36f492d9ead"
  initial_state: true
  # --------------------- TRIGGER ---------------------
  # after the plug was on for x minutes the switch goes off
  trigger:
    - platform: state
      entity_id: switch.zb_plug_l2_kitchen_microwave
      to: "on"
      for:
        minutes: 6
  # -------------------- CONDITIONS -------------------
  condition:
    - and:
        - condition: template
          value_template: "{{ states(trigger.entity_id) != 'on'}}"
        - condition: template
          value_template: '{{ (states("sensor.zb_plug_l2_kitchen_microwave_power") | float(0)) < 25 }}'
  # --------------------- ACTIONS ---------------------
  action:
    # ------------------ ZB Plug OFF ------------------
    service: switch.turn_off
    entity_id: switch.zb_plug_l2_kitchen_microwave
# ############################################################
#  END OF FILE
# ############################################################
