#
#   NOT FIT FOR PRODUCTION!!!
#
# ############################################################
#
#  automation for ZB Charger 01
#
# ############################################################

# ############################################################
# ZB Charger 01 turn off after x minutes
# ############################################################
- alias: Zigbee Charger 01 Timer
  id: "29322f0c-002b-41c9-991c-be1aff542f1b"
  initial_state: true
  # --------------------- TRIGGER ---------------------
  # after the plug was on for x minutes the switch goes off
  trigger:
    - platform: state
      entity_id: switch.zb_charger_01
      to: "on"
      for:
        hours: 1
        minutes: 45
  # -------------------- CONDITIONS -------------------
  condition:
    - and:
        - condition: template
          value_template: "{{ states(trigger.entity_id) != 'on'}}"
        - condition: template
          value_template: '{{ (states("sensor.spuhnote10pro_battery_level") | float(0)) >= (states("input_number.l2_charger01_max_percentage") | float(0)) }}'
  # --------------------- ACTIONS ---------------------
  action:
    # ------------------ ZB Plug OFF ------------------
    service: switch.turn_off
    entity_id: switch.zb_charger_01
# ############################################################
#  END OF FILE
# ############################################################
