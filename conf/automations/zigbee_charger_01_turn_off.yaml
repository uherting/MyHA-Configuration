# ############################################################
#
#  automation for Zigbee plug 02
#
# ############################################################

# ############################################################
# Zigbee plug 02 turn off after x minutes
# ############################################################
- alias: Zigbee Charger 01 Timer
  id: "29322f0c-002b-41c9-991c-be1aff542f1b"
  initial_state: true
  # --------------------- TRIGGER ---------------------
  # after the plug was on for x minutes the switch goes off
  trigger:
    - platform: state
      entity_id: switch.zb_plug_03
      to: "on"
      for:
        hours: 1
        minutes: 0
  # -------------------- CONDITIONS -------------------
  condition:
    - or:
        - condition: template
          value_template: "{{ states(trigger.entity_id) != 'on'}}"
        - condition: template
          value_template: '{{ (states("sensor.zb_plug_03_power") | float(0)) < 1 }}'
  # --------------------- ACTIONS ---------------------
  action:
    # ------------------ ZB Plug OFF ------------------
    service: switch.turn_off
    entity_id: switch.zb_plug_03
# ############################################################
#  END OF FILE
# ############################################################
