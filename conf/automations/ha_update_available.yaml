# ############################################################
#
#  Home assistant - update available
#
# ############################################################


# ############################################################
# ha_update_available
# ############################################################
- alias: HA update available
  id: 'ha_update_available old'
  initial_state: false
  trigger:
  - platform: state
    entity_id: binary_sensor.updater
#    from: 'unavailable'
    to: 'on'
#  condition: time
#    after: '07:00:00'
#    before: '07:02:00'
  action:
    - service: notify.ha_status_info
      data_template:
        message: >
          Home Assistant {{ state_attr('binary_sensor.updater', 'newest_version') }} is available.

- alias: HA update available
  id: 'ha_update_available'
  initial_state: true
  trigger:
    platform: state
    entity_id: updater.updater
  action:
    - service: notify.ha_status_info
      data_template:
        message: >
          Home Assistant {{ states.updater.updater.state }} now available
    - service: rest_command.github_create_issue_on_new_ha_version
      data_template:
        version: "{{ states.updater.updater.state }}"

############################################################
#  END OF FILE
# ############################################################

