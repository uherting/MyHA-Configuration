# ############################################################
#
#  Home assistant - update available
#
# ############################################################


# ############################################################
# ha_update_available notification and GitHub issue creation
# ############################################################
- alias: HA update available
  id: 'ha_update_available'
  initial_state: true

# --------------------- TRIGGER ---------------------
  trigger:
  - platform: state
    entity_id: binary_sensor.updater
#    from: 'unavailable'
    to: 'on'
# -------------------- CONDITIONS -------------------
  # none whatsoever
  condition: []

# --------------------- ACTIONS ---------------------
  action:
    - service: notify.ha_status_info
      data_template:
        message: >
          Home Assistant {{ state_attr('binary_sensor.updater', 'newest_version') }} is available.
    - service: rest_command.github_create_issue_on_new_ha_version
      data_template:
        version: "Home Assistant {{ state_attr('binary_sensor.updater', 'newest_version') }} is available."

############################################################
#  END OF FILE
# ############################################################
