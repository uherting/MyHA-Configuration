# ############################################################
#
#  automation for L9_TTGO cam #02 notify with text / pics
#
# ############################################################

# ############################################################
# cam going online
# ############################################################
- alias: Cam TTGO L9_02 went ONLINE
  id: "785c029d-3606-4e89-8b58-5e9f2ec277ab"
  initial_state: false
  # --------------------- TRIGGER ---------------------
  trigger:
    - platform: state
      entity_id: binary_sensor.l9_cam_ttgo_02_status
      from: "off"
      to: "on"
  # --------------------- ACTIONS ---------------------
  action:
    # ------------------- SEND NOTIFICATION -------------------
    - service: script.tg_txt_notification
      data_template:
        msg_message: >
          TTGO cam L9 02 online again

# ############################################################
# cam going offline
# ############################################################
- alias: Cam TTGO L9_02 went OFFLINE
  id: "86b21185-565e-440b-800d-4942da7299fd"
  initial_state: false
  # --------------------- TRIGGER ---------------------
  trigger:
    - platform: state
      entity_id: binary_sensor.l9_cam_ttgo_02_status
      from: "on"
      to: "off"
  # --------------------- ACTIONS ---------------------
  action:
    # ------------------- SEND NOTIFICATION -------------------
    - service: script.tg_txt_notification
      data_template:
        msg_message: >
          TTGO cam L9 02 went offline

# ############################################################
- alias: Cam TTGO L9_02 PIR
  id: "3bf1c2d8-9139-4c48-975e-9dbe247c4304"
  initial_state: true
  # --------------------- TRIGGER ---------------------
  trigger:
    - platform: state
      entity_id: binary_sensor.l9_cam_ttgo_02_pir
      to: "on"
  # --------------------- ACTIONS ---------------------
  action:
    # ------------------- CREATE SNAPSHOTS -------------------
    #      - delay: '00:00:02'
    - service: camera.snapshot
      data:
        entity_id: camera.l9_cam_ttgo_02_cam
        filename: "/config/var/opt/tg/l9ttgocam02/1.jpg"
    - delay: "00:00:01"
    - service: camera.snapshot
      data:
        entity_id: camera.l9_cam_ttgo_02_cam
        filename: "/config/var/opt/tg/l9ttgocam02/2.jpg"
    - delay: "00:00:01"
    - service: camera.snapshot
      data:
        entity_id: camera.l9_cam_ttgo_02_cam
        filename: "/config/var/opt/tg/l9ttgocam02/3.jpg"
    # ------------------- SEND NOTIFICATION -------------------
    - service: script.send_msg_txt_via_tg
      data:
        msg_title: "MOTION DETECTED"
        msg_message: "Motion was detected in area #1, 3 photos follow."

    - service: script.tg_files3_notification
      data:
        msg_filename_1: "/config/var/opt/tg/l9ttgocam02/1.jpg"
        msg_caption_1: "area 1, photo 1"
        msg_filename_2: "/config/var/opt/tg/l9ttgocam02/2.jpg"
        msg_caption_2: "area 1, photo 2"
        msg_filename_3: "/config/var/opt/tg/l9ttgocam02/3.jpg"
        msg_caption_3: "area 1, photo 3"
# ---------------------------------------------------------------

# ############################################################
#  END OF FILE
# ############################################################
