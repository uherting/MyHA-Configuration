####################################################################
# SCRIPTS

#script:
  # on_multi_click action of TB A4 (short click)
  - id: ssr_script_tb_01_click_on_press
    mode: restart
    then:
      # - logger.log: "script ssr_script_tb_01_click_short action."
      - if:
        condition:
          lambda: 'return (id(isLightBarOn));'
        then:                  
          # the light bar is on
          # trigger octo coupler so that the light bar will go off
          - script.execute: lightbar_script_oc_trigger_on_off
          - globals.set:
            id: isLightBarOnViaBtn
            value: 'false'
          - globals.set:
              id: isLightBarOn
              value: 'false'
          # SSR01 stays on. it will go off after motion stopped
        else:
          # the light bar is off
          # switch the SSR on no matter in which state it is
          - switch.turn_on: ${ssr01_id}
          - globals.set:
            id: isLightBarOnViaBtn
            value: 'true'
          # trigger octo coupler so that the light bar will go on
          - script.execute: lightbar_script_oc_trigger_on_off
          - globals.set:
              id: isLightBarOn
              value: 'true'
      # - logger.log: "The light bar was toggled."

####################################################################
# EOF
####################################################################
